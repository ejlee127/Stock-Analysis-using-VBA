'BootCamp - June 12, 2020. VBA to analyze meta stock data'This script will loop through all the stocks for one year and output the following information.'   * The ticker symbol.'   * Yearly change from opening price at the beginning of a given year to the closing price at the end of that year.'   * The percent change from opening price at the beginning of a given year to the closing price at the end of that year.'   * The total stock volume of the stock.'   * Highlighting positive change in green and negative change in red.'   * In a different table, return the ticker with the "Greatest % increase", "Greatest % decrease" and "Greatest total volume".Sub YearlyChange_Greatest_All()    'To read or handle the original data table    Dim ticker As String    Dim openprice, closeprice As Double    Dim vol As Long    Dim i As Long        'To find or write the yearly change for each ticker    Dim tickername As String    Dim changeprice As Double    Dim percent As Double    Dim totalvol As LongLong    Dim ti As Long    Dim tj As Integer        'To find the greatest values and its ticker    Dim H_increase As Double    Dim H_decrease As Double    Dim H_totalvol As LongLong    Dim i_ticker As String    Dim d_ticker As String    Dim v_ticker As String    'For each worksheet    For Each ws In Worksheets            'To set up the result table        ws.Cells(1, 9).Value = "Ticker"        ws.Cells(1, 10).Value = "Yearly Change"        ws.Cells(1, 11).Value = "Percent Change"        ws.Cells(1, 12).Value = "Total Stock Volume"                'To initialize the values for the yearly change for each ticker        openprice = 0        closeprice = 0        totalvol = 0        'To initialize the values for the greatest values        H_increase = 0        H_decrease = 0        H_totalvol = 0        'starting row index for the result table        ti = 2        'starting column index for the result table        tj = 9            'To read the first row        i = 2        ticker = ws.Cells(i, 1).Value                'Set up the first ticker name as the current(first) ticker        tickername = ticker                'Do the loop until ticker string(the first column) is null        While (ticker <> "")                'Case when new ticker appears            If (tickername <> ticker) Then                        'Finishing up writing the result table for the current ticker                            ws.Cells(ti, tj).Value = tickername                            changeprice = closeprice - openprice                ws.Cells(ti, tj + 1).Value = changeprice                            'Fill the cell with red or green according to the sign of changeprice                If changeprice < 0 Then                    ws.Cells(ti, tj + 1).Interior.ColorIndex = 3                Else                    ws.Cells(ti, tj + 1).Interior.ColorIndex = 4                End If                            'Calculate the percentage of yearly change from open price                ws.Cells(ti, tj + 2).NumberFormat = "0.00%"                If openprice = 0 Then                    MsgBox ("Oh, No! Zero Open Price!" & tickername & " in Sheet: " & ws.Name)                    ws.Cells(ti, tj + 2).Value = changeprice                Else                    'Calculate only the ratio because Cell format is percentage                    percent = (changeprice / openprice)                    ws.Cells(ti, tj + 2).Value = percent                End If                                ws.Cells(ti, tj + 3) = totalvol                            'Check whether the values hit the greatest value                If H_increase < percent Then                    H_increase = percent                    i_ticker = tickername                End If                            If H_decrease > percent Then                    H_decrease = percent                    d_ticker = tickername                End If                            If H_totalvol < totalvol Then                    H_totalvol = totalvol                    v_ticker = tickername                End If                            'Update the index and initialize variables for the new ticker                ti = ti + 1                tickername = ticker                openprice = 0                closeprice = 0                totalvol = 0                        End If                    'Read the price and vol for the current ticker            If openprice = 0 Then                openprice = ws.Cells(i, 3).Value            End If            closeprice = ws.Cells(i, 6).Value            vol = ws.Cells(i, 7).Value            totalvol = totalvol + vol             'Update the index and read new ticker            i = i + 1            ticker = ws.Cells(i, 1).Value                      Wend                'Wrting the ticker's name who has the highest value and the value        ws.Cells(1, tj + 6).Value = "In " + ws.Name        ws.Cells(1, tj + 7).Value = "ticker"        ws.Cells(1, tj + 8).Value = "Value"        ws.Cells(2, tj + 6).Value = "Greatest % Increase"        ws.Cells(2, tj + 7).Value = i_ticker        ws.Cells(2, tj + 8).Value = H_increase        ws.Cells(2, tj + 8).NumberFormat = "0.00%"        ws.Cells(3, tj + 6).Value = "Greatest % Decrease"        ws.Cells(3, tj + 7).Value = d_ticker        ws.Cells(3, tj + 8).Value = H_decrease        ws.Cells(3, tj + 8).NumberFormat = "0.00%"        ws.Cells(4, tj + 6).Value = "Greatest Total Volume"        ws.Cells(4, tj + 7).Value = v_ticker        ws.Cells(4, tj + 8).Value = H_totalvol    Next ws    End Sub    